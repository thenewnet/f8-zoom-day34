<html>

<head>
    <title>Day 34 - Product List App</title>
    <link rel="stylesheet" href="products-style.css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet" />

    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        function Products() {
            const [articles, setArticles] = React.useState({});
            const [loading, setLoading] = React.useState(true);
            const [article, setArticle] = React.useState(null);

            React.useEffect(() => {
                fetch('https://jsonplaceholder.typicode.com/posts?_limit=12')
                    .then(response => response.json())
                    .then(data => {
                        setArticles(data.map(article => ({
                            ...article,
                            title: article.title[0].toUpperCase() + article.title.slice(1),
                            bodyFixLength: article.body.length > 100 ? article.body.slice(0, 100) + '...' : article.body
                        })));
                    })
                    .finally(() => {
                        setLoading(false);
                    });
            }, []);

            const handleView = (article) => {
                setArticle(article);
            }

            return (
                <>
                    {
                        loading ? <p>Loading...</p> : (
                            <>
                                <div className="cards">
                                    {articles.map(article => (
                                        <div className="card">
                                            <div className="row">
                                                <div className="left">Id:</div>
                                                <div className="right">{article.id}</div>
                                            </div>

                                            <div className="row">
                                                <div className="left">Title:</div>
                                                <div className="right">{article.title}</div>
                                            </div>

                                            <div className="row">
                                                <div className="left">Body:</div>
                                                <div className="right">{article.bodyFixLength}</div>
                                            </div>

                                            <div className="row button-row">
                                                <button className="btn-view" onClick={() => handleView(article)}>Xem tiếp</button>
                                            </div>

                                        </div>
                                    ))}
                                </div>
                                {article &&
                                    <div className="modal-overlay" onClick={() => setArticle(null)}>
                                        <div className="modal" onClick={e => e.stopPropagation()}>
                                            <button className="close-btn" onClick={() => setArticle(null)}>✖</button>
                                            <h2>{article.title}</h2>
                                            <p>{article.body}</p>
                                        </div>
                                    </div>
                                }
                            </>
                        )
                    }

                </>

            );
        }

        const app = (
            <>
                <h1><a href="index.html"><i className="fa fa-home"></i></a> Profile Card App</h1>
                <Products />
            </>
        );

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(app);

    </script>


</body>

</html>